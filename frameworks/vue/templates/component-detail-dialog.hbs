<script setup lang="ts">
import { {{resourcePascalCase}}Model } from "../models/{{resourceSnakeCase}}_model";

interface Props {
	modelValue: boolean;
	{{resourceCamelCase}}: {{resourcePascalCase}}Model | null;
}

interface Emits {
	(e: "update:modelValue", value: boolean): void;
	(e: "edit", {{resourceCamelCase}}: {{resourcePascalCase}}Model): void;
	(e: "delete", {{resourceCamelCase}}: {{resourcePascalCase}}Model): void;
}

const props = defineProps<Props>();
const emit = defineEmits<Emits>();

const showDialog = computed({
	get: () => props.modelValue,
	set: (value) => emit("update:modelValue", value),
});

const closeDialog = () => {
	showDialog.value = false;
};
</script>

<template>
	<VDialog v-model="showDialog" max-width="700px" scrollable>
		<VCard v-if="{{resourceCamelCase}}">
			<!-- Header avec gradient -->
			<VCardTitle
				class="d-flex align-center pa-6"
				style="background: linear-gradient(135deg, #005aa7 0%, #009ddc 100%); color: white"
			>
				<VIcon icon="ri-file-list-3-line" size="48" class="me-4" />
				<div class="flex-grow-1">
					<div class="text-h5 font-weight-bold mb-1">Détails {{article resource}}{{resourceLowerCase}}</div>
					<div class="text-caption opacity-90">Informations complètes</div>
				</div>
				<VBtn icon="ri-close-line" variant="text" @click="closeDialog" color="white" />
			</VCardTitle>

			<VCardText class="pa-6">
				<VContainer fluid>
					<!-- Informations générales -->
					<div class="mb-6">
						<div class="text-h6 mb-4 d-flex align-center">
							<VIcon icon="ri-information-line" class="me-2" color="primary" />
							Informations générales
						</div>
						<VRow>
{{#each fields}}
{{#if (eq type "boolean")}}
							<VCol cols="12" md="6">
								<div class="info-item mb-4">
									<div class="text-caption text-medium-emphasis mb-1">{{description}}</div>
									<div class="d-flex align-center">
										<VIcon
											:icon="{{../resourceCamelCase}}.{{name}} ? 'ri-checkbox-circle-fill' : 'ri-close-circle-fill'"
											size="20"
											class="me-2"
											:color="{{../resourceCamelCase}}.{{name}} ? 'success' : 'error'"
										/>
										<VChip
											size="small"
											:color="{{../resourceCamelCase}}.{{name}} ? 'success' : 'error'"
											variant="tonal"
										>
											\{{ {{../resourceCamelCase}}.{{name}} ? "Oui" : "Non" }}
										</VChip>
									</div>
								</div>
							</VCol>
{{else if (eq type "Date")}}
							<VCol cols="12" md="6">
								<div class="info-item mb-4">
									<div class="text-caption text-medium-emphasis mb-1">{{description}}</div>
									<div class="d-flex align-center">
										<VIcon icon="ri-calendar-line" size="20" class="me-2" color="primary" />
										<span class="text-body-1">
											\{{ {{../resourceCamelCase}}.{{name}} ? new Date({{../resourceCamelCase}}.{{name}}).toLocaleDateString() : "N/A" }}
										</span>
									</div>
								</div>
							</VCol>
{{else}}
							<VCol cols="12" md="6">
								<div class="info-item mb-4">
									<div class="text-caption text-medium-emphasis mb-1">{{description}}</div>
									<div class="d-flex align-center">
										<VIcon icon="ri-text" size="20" class="me-2" color="primary" />
										<span class="text-body-1">\{{ {{../resourceCamelCase}}.{{name}} || "N/A" }}</span>
									</div>
								</div>
							</VCol>
{{/if}}
{{/each}}
						</VRow>
					</div>

					<VDivider class="my-4" />

					<!-- Informations système -->
					<div class="mb-4">
						<div class="text-h6 mb-4 d-flex align-center">
							<VIcon icon="ri-settings-line" class="me-2" color="primary" />
							Informations système
						</div>
						<VRow>
							<VCol cols="12" md="6">
								<div class="info-item">
									<div class="text-caption text-medium-emphasis mb-1">ID</div>
									<div class="d-flex align-center">
										<VIcon icon="ri-hashtag" size="20" class="me-2" color="primary" />
										<code class="text-body-2">\{{ {{resourceCamelCase}}.id }}</code>
									</div>
								</div>
							</VCol>
							<VCol cols="12" md="6">
								<div class="info-item">
									<div class="text-caption text-medium-emphasis mb-1">Date de création</div>
									<div class="d-flex align-center">
										<VIcon icon="ri-time-line" size="20" class="me-2" color="primary" />
										<span class="text-body-2">
											\{{ {{resourceCamelCase}}.created_at ? new Date({{resourceCamelCase}}.created_at).toLocaleString() : "N/A" }}
										</span>
									</div>
								</div>
							</VCol>
						</VRow>
					</div>
				</VContainer>
			</VCardText>

			<VCardActions class="pa-4 pt-0">
				<VSpacer />
				<VBtn
					color="primary"
					variant="text"
					prepend-icon="ri-pencil-line"
					@click="emit('edit', {{resourceCamelCase}})"
				>
					Modifier
				</VBtn>
				<VBtn
					color="error"
					variant="text"
					prepend-icon="ri-delete-bin-line"
					@click="emit('delete', {{resourceCamelCase}})"
				>
					Supprimer
				</VBtn>
			</VCardActions>
		</VCard>
	</VDialog>
</template>

<style scoped>
.opacity-90 {
	opacity: 0.9;
}

.info-item {
	padding: 8px 0;
}

code {
	background-color: rgba(0, 0, 0, 0.05);
	padding: 2px 8px;
	border-radius: 4px;
}
</style>
